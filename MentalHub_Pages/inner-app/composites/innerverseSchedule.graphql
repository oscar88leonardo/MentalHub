type InnerverProfile @loadModel(id: "$PROFILE_ID") {
    id: ID!
}

enum ScheduleState {
  Pending
  Confirmed
  Active
  Finished
  Cancelled
}

type Schedule
    @createModel(accountRelation: LIST, description: "Schedule Therapist") 
  @createIndex(fields: [{ path: "profileId" }])
  @createIndex(fields: [{ path: "therapistId" }])
  @createIndex(fields: [{ path: "state" }])
    {
    date_init: DateTime!
    date_finish: DateTime!
    edited: DateTime
    created: DateTime!
    profileId: StreamID! @documentReference(model: "InnerverProfile")
    profile: InnerverProfile! @relationDocument(property: "profileId")
  therapistId: StreamID! @documentReference(model: "InnerverProfile")
  therapist: InnerverProfile! @relationDocument(property: "therapistId")
  roomId: String! @string(minLength: 3, maxLength: 40)
    NFTContract: String! @string(maxLength: 50)
    TokenID: Int!
  state: ScheduleState!
}

type ScheduleGrant
  @createModel(accountRelation: LIST, description: "Delegaci√≥n de capability para un Schedule")
  @createIndex(fields: [{ path: "scheduleId" }])
  @createIndex(fields: [{ path: "audDid" }])
{
  scheduleId: StreamID!
  audDid: String! @string(maxLength: 200)
  cacao: String! @string(maxLength: 10000)
  expires: DateTime!
  created: DateTime!
}

# Extensiones de relaciones desde InnerverProfile hacia Schedule
extend type InnerverProfile {
  # Citas creadas por el consultante (profileId)
  schedules: [Schedule] @relationFrom(model: "Schedule", property: "profileId")

  # Citas asignadas al terapeuta (therapistId)
  therapist_sched: [Schedule] @relationFrom(model: "Schedule", property: "therapistId")
}
